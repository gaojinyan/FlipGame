<html>
<head>
	<title>Filpgame</title>
	<link rel="stylesheet" type="text/css" href="./css/index.css">
	<script type="text/javascript" src="./js/jquery.min.js"></script>
</head>
	<style>
		.back{
			z-index: -1;
			position: absolute;
			width: 123px;
		}
	</style>
<body>
	<div class="all">
		<ul id="grid">
			
		</ul>
	</div>
	<script type="text/javascript">
		
		function rand(m) {
			//随机打乱数组
		    var randArr = [];
		    for(var j = 0; j < 2;j++){
			    for (var i = 0; i < m; i++) {
			    	randArr.push(i)
			    }
		    }
		   for(var i = randArr.length-1; i >=0; i--){
		        var randomIndex = Math.floor(Math.random()*(i+1)); 
		        var itemAtIndex = randArr[randomIndex]; 
		        randArr[randomIndex] = randArr[i]; 
		        randArr[i] = itemAtIndex;

		    }
		    //生成坐标二维数组
			var arr = [];
			for (var i = 0; i < 4; i++){
				arr[i] = [];
				for(var j = 0; j < 4; j++){
					arr[i].push(j);
				}
			}
			
			//把打乱的数组放入二维数组里
			var i = 0;
			var res = arr.map(function(ba){         
			  return ba.map(function(bb){             
			       i++
			       return randArr[i-1]         
			   });
			});

			// var c = 0;
			// var a = [];
			// for (var i = 0; i < 8; i++){
			// 	a[i] = [];
			// 	for(var j = 0; j < 2; j++){
			// 		a[i][j] = randArr[c];
			// 		var str = "<li>"+ c +"</li>";
			// 			$("#grid").append(str);
			// 			$('li:eq('+ c +')').html("<div class='back'><img src='./image/" + i + ".jpg' width='100%' index='"+i+"'></div><div class='front'><img src='./image/all.jpg' width='100%'></div>");
			// 			c++;

			// 	}
			// }
			// console.log(a);
			//根据坐标显示图片
			var newImg = [];
			for(var i = 0; i < res.length; i++){
				for(var j = 0; j < res[i].length;j++){
 					newImg.push(  res[i][j]);
				}
			}
			for (var i = 0; i < newImg.length; i++) {
				var str = "<li value="+newImg[i]+">"+ i +"</li>";
				$("#grid").append(str);
				$('li:eq('+ i +')').html("<div class='back' ><img src='./image/" + newImg[i] + ".jpg' width='100%'></div><div class='front'><img src='./image/all.jpg' width='100%'></div>");
			};
		}
		rand(8)
		function dian(){
				var before = null;
				var beforeIndex = null;
				$('body').on('click','li',function(){
					var index = $(this).index();

					var backIndex = $(this).attr("value");
					if(before === null && beforeIndex === null){
						before = backIndex;
						beforeIndex = index;
						$('li:eq('+ index +') .back').css('z-index','2')
					}else{
						$('li:eq('+ index +') .back').css('z-index','2')
						if(index == beforeIndex){
							return false;
						}
						if(before == backIndex){
							$('li:eq('+ beforeIndex +') .back').css('z-index','2')
							$('li:eq('+ index +') .back').css('z-index','2')
							$('li:eq('+ beforeIndex +') .back').hide()
							$('li:eq('+ index +') .back').hide()
							$('li:eq('+ beforeIndex +') .front').hide()
							$('li:eq('+ index +') .front').hide()
							before = null;
							beforeIndex = null;
						}else{
							
							$('li:eq('+ index+') .back').css('z-index','2');
							 setTimeout('$("li:eq('+ beforeIndex +') .back").css("z-index","-1"); $("li:eq('+ index+') .back").css("z-index","-1")',500);
							before = null;
							beforeIndex = null;
						}
						 
					}
					
				});
		}
		dian()
	</script>
</body>
</html>